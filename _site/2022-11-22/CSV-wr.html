<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Xeoxxn_blog</title>

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css">
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700"
  />

  <!-- Font Awesome -->
  <link
    rel="stylesheet"
    type="text/css"
    href="/assets/css/fontawesome-all.min.css"
  />

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon.ico">

  <!-- Google tag (gtag.js) -->
  <script
    async
    src="https://www.googletagmanager.com/gtag/js?id=G-LVW35GS148"
  ></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "G-LVW35GS148");
  </script>

  <!-- Google Analytics
  
  <script>
    (function (i, s, o, g, r, a, m) {
      i["GoogleAnalyticsObject"] = r;
      (i[r] =
        i[r] ||
        function () {
          (i[r].q = i[r].q || []).push(arguments);
        }),
        (i[r].l = 1 * new Date());
      (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m);
    })(
      window,
      document,
      "script",
      "//www.google-analytics.com/analytics.js",
      "ga"
    );

    ga("create", "G-LVW35GS148", "auto");
    ga("send", "pageview");
  </script>
   -->
</head>


  <body>
    <nav class="nav">
      <div class="nav-container">
        <a href="/">
          <h2 class="nav-title">Xeoxxn_blog</h2>
        </a>
        <ul>
          <li><a href="/">About</a></li>
          <li><a href="/portfolio/">Portfolio</a></li>
        </ul>
    </div>
  </nav>

    <main>
      <div class="post">
  <h2 class="post-title">java-csv-write-and-read</h2>
  <div class="post-line"></div>

  <h1 id="java---간단한-csv-쓰고-읽기">JAVA - 간단한 CSV 쓰고 읽기</h1>

<p>별다른 라이브러리를 사용하지 않고 JDK 만 이용해서 파일읽고쓰기 기능 구현</p>

<h2 id="csvsheetjava"><code class="language-plaintext highlighter-rouge">CsvSheet.java</code></h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Objects</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.Collectors</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.Stream</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CsvSheet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">DELIMITER</span> <span class="o">=</span> <span class="s">","</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">SUFFIX_LINE_OF_END</span> <span class="o">=</span> <span class="s">"\n"</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">Row</span> <span class="n">header</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Row</span><span class="o">&gt;</span> <span class="n">rows</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>


    <span class="kd">public</span> <span class="nc">CsvSheet</span> <span class="nf">registerHeader</span><span class="o">(</span><span class="nc">Row</span> <span class="n">header</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">header</span> <span class="o">=</span> <span class="n">header</span><span class="o">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasHeader</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Objects</span><span class="o">.</span><span class="na">nonNull</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">header</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">CsvSheet</span> <span class="nf">addRow</span><span class="o">(</span><span class="nc">Row</span> <span class="n">row</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">rows</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">row</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getHeadlessRows</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">rows</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">map</span><span class="o">(</span><span class="nl">Row:</span><span class="o">:</span><span class="n">getStringRow</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getTotalRows</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">hasHeader</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getStringRow</span><span class="o">());</span>
            <span class="n">list</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">getHeadlessRows</span><span class="o">());</span>
            <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="nf">getHeadlessRows</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">CsvSheet</span> <span class="nf">addRows</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Row</span><span class="o">&gt;</span> <span class="n">rows</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">rows</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">rows</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@NoArgsConstructor</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Row</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Cell</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;&gt;</span> <span class="n">cells</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

        <span class="kd">public</span> <span class="nf">Row</span><span class="o">(</span><span class="no">T</span><span class="o">...</span> <span class="n">objs</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">cells</span> <span class="o">=</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">objs</span><span class="o">)</span>
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">Cell:</span><span class="o">:</span><span class="k">new</span><span class="o">)</span>
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="nc">Row</span> <span class="nf">addCell</span><span class="o">(</span><span class="nc">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">cells</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Cell</span><span class="o">(</span><span class="n">value</span><span class="o">));</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getStringRow</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">cells</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">map</span><span class="o">(</span><span class="nl">Cell:</span><span class="o">:</span><span class="n">getStringValue</span><span class="o">)</span>
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">joining</span><span class="o">(</span><span class="no">DELIMITER</span><span class="o">,</span> <span class="s">""</span><span class="o">,</span> <span class="no">SUFFIX_LINE_OF_END</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Getter</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Cell</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="no">T</span> <span class="n">value</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">Cell</span><span class="o">(</span><span class="no">T</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getStringValue</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nf">getValue</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="csvfilewriterjava"><code class="language-plaintext highlighter-rouge">CsvFileWriter.java</code></h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.extern.slf4j.Slf4j</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileWriter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Files</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>

<span class="nd">@Slf4j</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CsvFileWriter</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">FILE_EXTENSION</span> <span class="o">=</span> <span class="s">"csv"</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">write</span><span class="o">(</span><span class="nc">String</span> <span class="n">fileName</span><span class="o">,</span> <span class="nc">CsvSheet</span> <span class="n">csvSheet</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">csvFileName</span> <span class="o">=</span> <span class="n">getSourceFile</span><span class="o">(</span><span class="n">fileName</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Generate csv file: {}"</span><span class="o">,</span> <span class="n">csvFileName</span><span class="o">);</span>

        <span class="nc">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">csvFileName</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">create</span><span class="o">(</span><span class="n">file</span><span class="o">,</span> <span class="n">csvSheet</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">append</span><span class="o">(</span><span class="n">csvFileName</span><span class="o">,</span> <span class="n">csvSheet</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">append</span><span class="o">(</span><span class="nc">String</span> <span class="n">csvFileName</span><span class="o">,</span> <span class="nc">CsvSheet</span> <span class="n">csvSheet</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">(</span><span class="nc">FileWriter</span> <span class="n">fw</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileWriter</span><span class="o">(</span><span class="n">csvFileName</span><span class="o">,</span> <span class="kc">true</span><span class="o">))</span> <span class="o">{</span>
            <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>

            <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">strRow</span> <span class="o">:</span> <span class="n">csvSheet</span><span class="o">.</span><span class="na">getHeadlessRows</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">strRow</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="n">fw</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
            <span class="n">fw</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"CSV file append exception"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">"CSV file append exception"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">create</span><span class="o">(</span><span class="nc">File</span> <span class="n">file</span><span class="o">,</span> <span class="nc">CsvSheet</span> <span class="n">csvSheet</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">(</span><span class="nc">FileWriter</span> <span class="n">fw</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileWriter</span><span class="o">(</span><span class="n">file</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">hasHeader</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">fw</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getHeader</span><span class="o">().</span><span class="na">getStringRow</span><span class="o">());</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">fw</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="s">"\n"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"CSV File Create Exception"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">"CSV File Create Exception"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">delete</span><span class="o">(</span><span class="nc">String</span> <span class="n">fileName</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">csvFileName</span> <span class="o">=</span> <span class="n">getSourceFile</span><span class="o">(</span><span class="n">fileName</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Generate csv file: {}"</span><span class="o">,</span> <span class="n">csvFileName</span><span class="o">);</span>
        <span class="nc">Files</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">fileName</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="nf">getSourceFile</span><span class="o">(</span><span class="nc">String</span> <span class="n">fileName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%s.%s"</span><span class="o">,</span> <span class="n">fileName</span><span class="o">,</span> <span class="no">FILE_EXTENSION</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="csvfilereaderjava"><code class="language-plaintext highlighter-rouge">CsvFileReader.java</code></h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.extern.slf4j.Slf4j</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileReader</span><span class="o">;</span>

<span class="nd">@Slf4j</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CsvFileReader</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">CsvSheet</span> <span class="nf">read</span><span class="o">(</span><span class="nc">String</span> <span class="n">fileName</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">fileName</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"요청하신 CSV 파일(이름: %s)이 존재하지 않습니다."</span><span class="o">,</span> <span class="n">fileName</span><span class="o">));</span>
        <span class="o">}</span>

        <span class="nc">CsvSheet</span> <span class="n">csvSheet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">(</span><span class="nc">FileReader</span> <span class="n">filereader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileReader</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
             <span class="nc">BufferedReader</span> <span class="n">bufReader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="n">filereader</span><span class="o">))</span> <span class="o">{</span>

            <span class="kt">int</span> <span class="n">rowCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="nc">String</span> <span class="n">line</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">bufReader</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">rowCount</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">header</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="n">line</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="nc">CsvSheet</span><span class="o">.</span><span class="na">DELIMITER</span><span class="o">));</span>
                    <span class="n">csvSheet</span><span class="o">.</span><span class="na">registerHeader</span><span class="o">(</span><span class="n">header</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">csvSheet</span><span class="o">.</span><span class="na">addRow</span><span class="o">(</span><span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="n">line</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="nc">CsvSheet</span><span class="o">.</span><span class="na">DELIMITER</span><span class="o">)));</span>
                <span class="o">}</span>
                <span class="n">rowCount</span><span class="o">++;</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"CSV 파일을 읽던 중 오류가 발생했습니다."</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">csvSheet</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="테스트-코드">테스트 코드</h2>

<h3 id="csvsheettestjava"><code class="language-plaintext highlighter-rouge">CsvSheetTest.java</code></h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">assertj</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertThat</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">CsvSheetTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"CsvSheet - 헤더없음"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">test01</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//expect</span>
        <span class="nc">CsvSheet</span> <span class="n">csvSheet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">();</span>

        <span class="c1">//then</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">hasHeader</span><span class="o">()).</span><span class="na">isFalse</span><span class="o">();</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getRows</span><span class="o">()).</span><span class="na">isEmpty</span><span class="o">();</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getTotalRows</span><span class="o">()).</span><span class="na">isEmpty</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"CsvSheet - 헤더확인"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">test02</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//given</span>
        <span class="nc">CsvSheet</span> <span class="n">csvSheet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">();</span>

        <span class="c1">//when</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">header</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"header1"</span><span class="o">,</span> <span class="s">"header2"</span><span class="o">,</span> <span class="s">"header3"</span><span class="o">);</span>
        <span class="n">csvSheet</span><span class="o">.</span><span class="na">registerHeader</span><span class="o">(</span><span class="n">header</span><span class="o">);</span>

        <span class="c1">//when</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">hasHeader</span><span class="o">()).</span><span class="na">isTrue</span><span class="o">();</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getTotalRows</span><span class="o">()).</span><span class="na">hasSize</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getTotalRows</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"header1,header2,header3\n"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"CsvSheet - 본문추가"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">test03</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//given</span>
        <span class="nc">CsvSheet</span> <span class="n">csvSheet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">();</span>

        <span class="c1">//when</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row1-1"</span><span class="o">,</span> <span class="s">"row1-2"</span><span class="o">,</span> <span class="s">"row1-3"</span><span class="o">);</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row2-1"</span><span class="o">,</span> <span class="s">"row2-2"</span><span class="o">,</span> <span class="s">"row2-3"</span><span class="o">);</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row3-1"</span><span class="o">,</span> <span class="s">"row3-2"</span><span class="o">,</span> <span class="s">"row3-3"</span><span class="o">);</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">&gt;</span> <span class="n">rows</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">row1</span><span class="o">,</span> <span class="n">row2</span><span class="o">,</span> <span class="n">row3</span><span class="o">);</span>
        <span class="n">csvSheet</span><span class="o">.</span><span class="na">addRows</span><span class="o">(</span><span class="n">rows</span><span class="o">);</span>

        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">hasHeader</span><span class="o">()).</span><span class="na">isFalse</span><span class="o">();</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getTotalRows</span><span class="o">()).</span><span class="na">hasSize</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getTotalRows</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row1-1,row1-2,row1-3\n"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getTotalRows</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row2-1,row2-2,row2-3\n"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getTotalRows</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">2</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row3-1,row3-2,row3-3\n"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="csvfilewritertestjava"><code class="language-plaintext highlighter-rouge">CsvFileWriterTest.java</code></h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.junit.jupiter.api.AfterEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.format.DateTimeFormatter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">assertj</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertThat</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">CsvFileWriterTest</span> <span class="o">{</span>
    <span class="nc">CsvFileWriter</span> <span class="n">csvFileWriter</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">fileName</span><span class="o">;</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">setUp</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">fileName</span> <span class="o">=</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="na">now</span><span class="o">().</span><span class="na">format</span><span class="o">(</span><span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ofPattern</span><span class="o">(</span><span class="s">"yyyy-MM-dd"</span><span class="o">));</span>
        <span class="n">csvFileWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvFileWriter</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@AfterEach</span>
    <span class="kt">void</span> <span class="nf">tearDown</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">File</span> <span class="n">csvFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%s.%s"</span><span class="o">,</span> <span class="n">fileName</span><span class="o">,</span> <span class="s">"csv"</span><span class="o">));</span>
        <span class="n">csvFile</span><span class="o">.</span><span class="na">delete</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"CsvFileWriter - 파일생성"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">test01</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//given</span>
        <span class="nc">CsvSheet</span> <span class="n">csvSheet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">();</span>

        <span class="c1">//when</span>
        <span class="n">csvFileWriter</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileName</span><span class="o">,</span> <span class="n">csvSheet</span><span class="o">);</span>

        <span class="c1">//then</span>
        <span class="nc">File</span> <span class="n">csvFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%s.%s"</span><span class="o">,</span> <span class="n">fileName</span><span class="o">,</span> <span class="s">"csv"</span><span class="o">));</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvFile</span><span class="o">.</span><span class="na">exists</span><span class="o">()).</span><span class="na">isTrue</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"CsvFileWriter - 본문작성"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">test02</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">//given</span>
        <span class="nc">CsvSheet</span> <span class="n">csvSheet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">();</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">header</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"header1"</span><span class="o">,</span> <span class="s">"header2"</span><span class="o">,</span> <span class="s">"header3"</span><span class="o">);</span>
        <span class="n">csvSheet</span><span class="o">.</span><span class="na">registerHeader</span><span class="o">(</span><span class="n">header</span><span class="o">);</span>

        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row1-1"</span><span class="o">,</span> <span class="s">"row1-2"</span><span class="o">,</span> <span class="s">"row1-3"</span><span class="o">);</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row2-1"</span><span class="o">,</span> <span class="s">"row2-2"</span><span class="o">,</span> <span class="s">"row2-3"</span><span class="o">);</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row3-1"</span><span class="o">,</span> <span class="s">"row3-2"</span><span class="o">,</span> <span class="s">"row3-3"</span><span class="o">);</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">&gt;</span> <span class="n">rows</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">row1</span><span class="o">,</span> <span class="n">row2</span><span class="o">,</span> <span class="n">row3</span><span class="o">);</span>
        <span class="n">csvSheet</span><span class="o">.</span><span class="na">addRows</span><span class="o">(</span><span class="n">rows</span><span class="o">);</span>

        <span class="c1">//when</span>
        <span class="n">csvFileWriter</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileName</span><span class="o">,</span> <span class="n">csvSheet</span><span class="o">);</span>

        <span class="nc">File</span> <span class="n">csvFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%s.%s"</span><span class="o">,</span> <span class="n">fileName</span><span class="o">,</span> <span class="s">"csv"</span><span class="o">));</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvFile</span><span class="o">.</span><span class="na">exists</span><span class="o">()).</span><span class="na">isTrue</span><span class="o">();</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">strRows</span> <span class="o">=</span> <span class="n">readFile</span><span class="o">(</span><span class="n">csvFile</span><span class="o">);</span>

        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">).</span><span class="na">hasSize</span><span class="o">(</span><span class="mi">4</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"header1,header2,header3"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row1-1,row1-2,row1-3"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">2</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row2-1,row2-2,row2-3"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">3</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row3-1,row3-2,row3-3"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">readFile</span><span class="o">(</span><span class="nc">File</span> <span class="n">csvFile</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">strRows</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="k">try</span> <span class="o">(</span><span class="nc">FileReader</span> <span class="n">filereader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileReader</span><span class="o">(</span><span class="n">csvFile</span><span class="o">);</span>
             <span class="nc">BufferedReader</span> <span class="n">bufReader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="n">filereader</span><span class="o">))</span> <span class="o">{</span>

            <span class="nc">String</span> <span class="n">line</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">bufReader</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">strRows</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="n">e</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">strRows</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"CsvFileWriter - 붙여쓰기 확인"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">test03</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">//given</span>
        <span class="nc">CsvSheet</span> <span class="n">csvSheet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">();</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">header</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"header1"</span><span class="o">,</span> <span class="s">"header2"</span><span class="o">,</span> <span class="s">"header3"</span><span class="o">);</span>
        <span class="n">csvSheet</span><span class="o">.</span><span class="na">registerHeader</span><span class="o">(</span><span class="n">header</span><span class="o">);</span>

        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row1-1"</span><span class="o">,</span> <span class="s">"row1-2"</span><span class="o">,</span> <span class="s">"row1-3"</span><span class="o">);</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row2-1"</span><span class="o">,</span> <span class="s">"row2-2"</span><span class="o">,</span> <span class="s">"row2-3"</span><span class="o">);</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row3-1"</span><span class="o">,</span> <span class="s">"row3-2"</span><span class="o">,</span> <span class="s">"row3-3"</span><span class="o">);</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">&gt;</span> <span class="n">rows</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">row1</span><span class="o">,</span> <span class="n">row2</span><span class="o">,</span> <span class="n">row3</span><span class="o">);</span>
        <span class="n">csvSheet</span><span class="o">.</span><span class="na">addRows</span><span class="o">(</span><span class="n">rows</span><span class="o">);</span>

        <span class="n">csvFileWriter</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileName</span><span class="o">,</span> <span class="n">csvSheet</span><span class="o">);</span>

        <span class="nc">CsvSheet</span> <span class="n">otherCsvSheet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">();</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row4</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row4-1"</span><span class="o">,</span> <span class="s">"row4-2"</span><span class="o">,</span> <span class="s">"row4-3"</span><span class="o">);</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row5</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row5-1"</span><span class="o">,</span> <span class="s">"row5-2"</span><span class="o">,</span> <span class="s">"row5-3"</span><span class="o">);</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row6</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row6-1"</span><span class="o">,</span> <span class="s">"row6-2"</span><span class="o">,</span> <span class="s">"row6-3"</span><span class="o">);</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">&gt;</span> <span class="n">otherRows</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">row4</span><span class="o">,</span> <span class="n">row5</span><span class="o">,</span> <span class="n">row6</span><span class="o">);</span>
        <span class="n">otherCsvSheet</span><span class="o">.</span><span class="na">addRows</span><span class="o">(</span><span class="n">otherRows</span><span class="o">);</span>

        <span class="n">csvFileWriter</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileName</span><span class="o">,</span> <span class="n">otherCsvSheet</span><span class="o">);</span>

        <span class="nc">File</span> <span class="n">csvFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%s.%s"</span><span class="o">,</span> <span class="n">fileName</span><span class="o">,</span> <span class="s">"csv"</span><span class="o">));</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvFile</span><span class="o">.</span><span class="na">exists</span><span class="o">()).</span><span class="na">isTrue</span><span class="o">();</span>


        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">strRows</span> <span class="o">=</span> <span class="n">readFile</span><span class="o">(</span><span class="n">csvFile</span><span class="o">);</span>

        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">).</span><span class="na">hasSize</span><span class="o">(</span><span class="mi">7</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"header1,header2,header3"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row1-1,row1-2,row1-3"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">2</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row2-1,row2-2,row2-3"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">3</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row3-1,row3-2,row3-3"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">4</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row4-1,row4-2,row4-3"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">5</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row5-1,row5-2,row5-3"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">strRows</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">6</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row6-1,row6-2,row6-3"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="csvfilereadertestjava"><code class="language-plaintext highlighter-rouge">CsvFileReaderTest.java</code></h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.junit.jupiter.api.AfterEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.format.DateTimeFormatter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">assertj</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertThat</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">assertj</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertThatThrownBy</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">CsvFileReaderTest</span> <span class="o">{</span>
    <span class="nc">CsvFileWriter</span> <span class="n">csvFileWriter</span><span class="o">;</span>
    <span class="nc">CsvFileReader</span> <span class="n">csvFileReader</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">fileName</span><span class="o">;</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">setUp</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">fileName</span> <span class="o">=</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="na">now</span><span class="o">().</span><span class="na">format</span><span class="o">(</span><span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ofPattern</span><span class="o">(</span><span class="s">"yyyy-MM-dd"</span><span class="o">));</span>
        <span class="n">csvFileWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvFileWriter</span><span class="o">();</span>
        <span class="n">csvFileReader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvFileReader</span><span class="o">();</span>

        <span class="n">writeDummyData</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">writeDummyData</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">CsvSheet</span> <span class="n">csvSheet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">();</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">header</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"header1"</span><span class="o">,</span> <span class="s">"header2"</span><span class="o">,</span> <span class="s">"header3"</span><span class="o">);</span>
        <span class="n">csvSheet</span><span class="o">.</span><span class="na">registerHeader</span><span class="o">(</span><span class="n">header</span><span class="o">);</span>

        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row1-1"</span><span class="o">,</span> <span class="s">"row1-2"</span><span class="o">,</span> <span class="s">"row1-3"</span><span class="o">);</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row2-1"</span><span class="o">,</span> <span class="s">"row2-2"</span><span class="o">,</span> <span class="s">"row2-3"</span><span class="o">);</span>
        <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span> <span class="n">row3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">(</span><span class="s">"row3-1"</span><span class="o">,</span> <span class="s">"row3-2"</span><span class="o">,</span> <span class="s">"row3-3"</span><span class="o">);</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">CsvSheet</span><span class="o">.</span><span class="na">Row</span><span class="o">&gt;</span> <span class="n">rows</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">row1</span><span class="o">,</span> <span class="n">row2</span><span class="o">,</span> <span class="n">row3</span><span class="o">);</span>
        <span class="n">csvSheet</span><span class="o">.</span><span class="na">addRows</span><span class="o">(</span><span class="n">rows</span><span class="o">);</span>

        <span class="n">csvFileWriter</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileName</span><span class="o">,</span> <span class="n">csvSheet</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@AfterEach</span>
    <span class="kt">void</span> <span class="nf">tearDown</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">File</span> <span class="n">csvFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%s.%s"</span><span class="o">,</span> <span class="n">fileName</span><span class="o">,</span> <span class="s">"csv"</span><span class="o">));</span>
        <span class="n">csvFile</span><span class="o">.</span><span class="na">delete</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"CsvFileReader - 존재하지 않는 파일 읽기 오류 발생"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">test01</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assertThatThrownBy</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">csvFileReader</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="s">"NONE-EXIST-FILE"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">isInstanceOf</span><span class="o">(</span><span class="nc">IllegalArgumentException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
            <span class="o">.</span><span class="na">hasMessage</span><span class="o">(</span><span class="s">"요청하신 CSV 파일(이름: NONE-EXIST-FILE)이 존재하지 않습니다."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"CsvFileReader - 정상 파일읽기"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">test02</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//expect</span>
        <span class="nc">CsvSheet</span> <span class="n">csvSheet</span> <span class="o">=</span> <span class="n">csvFileReader</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%s.%s"</span><span class="o">,</span> <span class="n">fileName</span><span class="o">,</span> <span class="s">"csv"</span><span class="o">));</span>

        <span class="c1">//then</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">hasHeader</span><span class="o">()).</span><span class="na">isTrue</span><span class="o">();</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getHeader</span><span class="o">().</span><span class="na">getStringRow</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"header1,header2,header3\n"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getHeadlessRows</span><span class="o">()).</span><span class="na">hasSize</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getHeadlessRows</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row1-1,row1-2,row1-3\n"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getHeadlessRows</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row2-1,row2-2,row2-3\n"</span><span class="o">);</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">csvSheet</span><span class="o">.</span><span class="na">getHeadlessRows</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">2</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"row3-1,row3-2,row3-3\n"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

</div>

<div class="pagination">
  
  <h2>Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    let PAGE_URL = "http://localhost:4000/2022-11-22/CSV-wr";
    let PAGE_IDENTIFIER = "/2022-11-22/CSV-wr";
    var disqus_config = function () {
      this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };

    (function () {
      // DON'T EDIT BELOW THIS LINE
      var d = document,
        s = d.createElement("script");
      s.src = "https://xeoxxn-blog.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript
    >Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript"
      >comments powered by Disqus.</a
    ></noscript
  >
   
  <a href="/2022-11-23/MarkDown_Practice" class="left next"
    >Prev</a
  >
   

  <a href="#" class="top">Top</a>
</div>

    </main>

    <footer>
      <span>
        &copy; <time datetime="2022-11-28 09:31:24 +0900">2022</time> Seojun Lee. <a href="https://github.com/kssim/about-portfolio/">A.P</a> theme by kssim.
      </span>
    </footer>
  </body>
</html>
